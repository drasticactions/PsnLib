{"name":"Psnlib","tagline":"A C# .Net PlayStation Network Library","body":"### PsnLib: A Playstation Network .NET Library\r\n\r\nPsnLib is a library for accessing the PlayStation Network in .NET. Currently, it is being used as the foundation for a new Windows Store/Windows Phone application, PSN Messenger.\r\n\r\n![PSN Messenger App 1](http://i.imgur.com/jfsCUGh.png)\r\n\r\nBut it should be flexible enough so you can use it with any .NET application. \r\n\r\n### Getting Started\r\n\r\nCurrently I am working on creating actual documentation, but here is the primer that should get you making basic calls (pending on the PSN API actually being online).\r\n\r\nThe PSN API implements a RESTful API, using OAuth2 for authentication.\r\n\r\nIn normal Sony written apps, the user is directed to a Sony web page where they input their user information. Then they get redirected back to the application or webpage that sent them. Their redirect URLs are hard coded; you can't change them without having their API throw an error. So as a work around, PsnLib fakes the HTTP response so we get a URL Auth code directly from their servers. Then we can get the access and refresh tokens and start making authenticated requests. While this is not necessarily the ideal (users may worry because you, the developer, are handling their user login information directly instead of going to the Sony site) but it's the easiest way to actually get the user in and going.\r\n\r\n```\r\nvar authManager = new AuthenticationManager();\r\nvar user = await authManager.Authenticate(email, password);\r\n```\r\n\r\nIf the user was logged in successfully, the authentication manager will return a UserAccountEntity. If it failed, it will be null. If the server errors out (which is bound to happen given how the PSN has been behaving), it will throw an exception.\r\n\r\nOnce you have the UserAccountEntity, you can start making authenticated calls. All Oauth from here are out (including refreshing the access token) is handled by the library.\r\n\r\nFor example:\r\n\r\n```\r\nUserAccountEntity.User user = await authManager.GetUserEntity(userAccountEntity);\r\n```\r\n\r\nWill get the current users information (OnlineID, Avatar, and so on).\r\n\r\nNow let's say we want compare trophies with a different user, then that a games specific trophy list.\r\n\r\nFirst\r\n\r\n```\r\nstring username = \"DrasticOverload\";\r\nint offset = 0;\r\nvar trophyList = await _trophyManager.GetTrophyList(username, offset, UserAccountEntity);\r\n```\r\n\r\nAs you may recall, the UserAccountEntity is what we were returned when we logged in. We need this so we can authenticate with Sony's servers. The username is, well, the username. And the offset is an int where the trophy list will start from. Their API returns 64 trophies at a time, so if you want to keep going through a users trophy list, once you hit the end of initial list you can call with the offset value to get the remaining ones.\r\n\r\nThe trophy list is returned as a TrophyEntity, which has the total number of trophies for that user, the next offset, the current limit, and a List of TrophyTitle. A TrophyTitle has the bunch of infromation, including the both you and the compared user and how many trophies from that game each have, the game itself and its trophy information.\r\n\r\nNow, we want to check the detailed information on that games specific trophies. Using trophyList from above, we do this.\r\n\r\n```\r\nTrophyTitle trophy = trophyList.TrophyTitles.First();\r\nvar trophyDetailManager = new TrophyDetailManager();\r\nbool showHiddenTrophies = true;\r\nvar trophys =\r\n                await\r\n                    trophyDetailManager .GetTrophyDetailList(trophy.npCommunicationId,\r\n                        userName, showHiddenTrophies,\r\n                        UserAccountEntity);\r\n``` \r\n\r\nIn this, we need the games npCommunicationId, so we can get the rest of the list. We want to compare the individual trophies with the user from before, so we keep that the same. showHiddenTrophies is set if we want to include or hide hidden trophies (They return from the API as hidden, you can't see what they are from it.) and the same UserAccountEntity from before.\r\n\r\nNow you will get a list of individual trophies, which you can then parse through.","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}